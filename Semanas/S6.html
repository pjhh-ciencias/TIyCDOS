
<!DOCTYPE html PUBLIC >

<html lang="es">
  <head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!-- Following part is mathjax, for latex-->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>


    <!-- This part is for jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>


    <!-- This part is to load main.js -->
    <script type="text/javascript" src="../main.js"></script>


    <!-- Next part is for new coomands -->
    <script>
      window.MathJax = {
        tex: {
          macros: {
            sen: "\\operatorname{sen}",
            seg: ["\\overrightarrow{#1}", 1]
          },
          tags: "ams", /* this part is for numbered equations */
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
      };
    </script>

    <!-- This part is for using single $ for latex input, instead of \(\) -->
    <!--<script>
        MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
            },
        svg: {
            fontCache: 'global'
        }
    };
    </script>-->

    <!-- CSS -->

    <link rel="stylesheet" , href="../style.css" />

    <!-- This part restart counter of cards to start at n+1 -->
    <style>
        body.number-title{
          counter-reset: sectionCounter 5 cardCounter ;
        }
        h1.number-title{
          counter-reset: sectionCounter 5 cardCounter ;
        }
      </style>
  
    <!-- Top Menu  -->


    <header class="main-header">
        <h1> Tecnolologías de la información y comunicación II  </h1>
       <nav class="top-nav">
        <ul>
            <li> <a href="https://pjhh-ciencias.github.io/TIyCDOS/Home.html"> Inicio  </a> </li>
            <li> <a href="https://pjhh-ciencias.github.io/TIyCDOS/Informacion_General.html"> Información general </a> </li>
            <li> <a href="https://pjhh-ciencias.github.io/TIyCDOS/Notas.html"> Notas  </a> </li>
            <li> <a href="https://pjhh-ciencias.github.io/TIyCDOS/Enlaces_externos.html"> Links </a> </li>
           <!--  <li> <a href="./ExternalLinks.html"> Links </a> </li> -->
          
              
            </ul>
       </nav>
       <!-- 
        <nav class="small-nav" align=right>
          <button onclick="myFunction()">Claro/Obscuro 
        </nav> 
      -->

      </header>

      <!-- This part is for title in tab-->
      <title> § 6 </title>
    
  </head>

<body class="fondo-body" >

<h1 class="number-title flexbox"> Semana del 22 de mayo</h1>


<div class="nota-box">

<h2 class="number-title"> Consultas:  Combinaciones</h2>

<div class="flexbox">
    <img src="..\Imagenes\S6\nueva_combinacion.PNG" alt="relaciones" width="40%" height="auto">
  </div>


Si no ve una relación entre los campos coincidentes, puede  agregar una combinación.
Arrastre el campo que desee de un origen de datos hasta el campo correspondiente de otro origen de datos. 
La tabla desde la que arrastra es la que aparecerá a la izquierda en el cuadro de diálogo Propiedades de la combinación.
De forma predeterminada, Access crea una <em>combinación interna</em>.
Si necesita una <em>combinación externa</em>, puede  cambiar su tipo.





<h2 class="number-title"> Consultas:  Combinaciones internas y combinaciones externas </h2>


<div class="flexbox">
    <img src="..\Imagenes\S6\Combinaciones.PNG" alt="relaciones" width="40%" height="auto">
  </div>

<h3>Combinaciones internas</h3>
<p>
Solo incluye las filas (registros) en la que los campos combinados de ambas tablas sean iguales.
</p>



<p>
Las combinaciones internas solo muestran los datos cuando hay un identificador coincidente de ambos orígenes de datos 
conectados. 
</p>

<p>
<b>Ejemplo:</b> si desea mostrar los productos y cantidades vendidos, debe crear una combinación interna entre
las tablas Productos y Detalles del pedido. Cuando se ejecuta la consulta, solo devolverá los productos que aparecen 
en pedidos (solo los productos que tienen pedidos asociados con ellos) y que, por tanto, aparecen en ambas tablas 
</p>


<h3>Combinaciones externas</h3>

<p>
A veces, en las consultas, desea ver todos los registros de una tabla junto con los registros coincidentes de otra.
Para ello, podemos utilizar las <b>combinaciones externas</b>. Las combinaciones externas devuelven todos los datos
de un origen de datos y algunos de los datos de otro origen de datos o tabla.
</p>

<p>
<b>Ejemplo:</b> si desea ver qué productos todavía no ha vendido, cree una consulta que muestre la Id. de producto
de la tabla Productos y las Id. de pedido coincidentes de la tabla Detalles de pedidos. Los productos que no tengan 
registros coincidentes en la tabla Detalles de pedido devuelven el nombre del producto sin ningún valor en el 
campo Id. de pedido.   
</p>

<h3>Combinaciones externas izquierdas y combinaciones externas derechas</h3>

<p>
En una combinación externa, la tabla que muestra <b>todos sus registros</b> se denomina <b>tabla base.</b>
La tabla que muestra <b>solo algunos registros</b> (coincidentes) se denomina <b>tabla secundaria.</b>
</p>

<ol>
 <b> <li><h3>Combinaciones externas izquierdas </h3></li>  </b>

<p>
Incluye <b>todos</b> los registros de la tabla con el nombre Izquierda y <b>solo</b> aquellos registros de la tabla
con el nombre Derecha en los que los campos combinados sean iguales, por ejemplo, todos los pedidos,
pero solo las cantidades y el Id. de producto de aquellos pedidos que tienen productos asociados con ellos.   
</p>

 <b> <li><h3>Combinaciones externas derchas </h3></li>  </b>

<p>
Incluye <b>todos</b> los registros de la tabla con el nombre Derecha y <b>solo</b> aquellos registros de la tabla con el nombre
Izquierda en los que los campos combinados sean iguales, por ejemplo,todos los productos,
incluso aquellos para los que no hay pedido, en cuyo caso mostrará valores en blanco en los campos Cantidad 
e Id. de pedido.   
</p>
</ol>


<p>
<b>Observacion:</b> Es importante saber qué tabla está a la izquierda y cuál está a la derecha, pues puede diferenciar 
la forma en la que las tablas se organizan en la ventana de consulta. Para entender qué datos recibirá de su consulta,
lea el texto cuidadosamente en el cuadro de diálogo Propiedades de la combinación.
</p>
<h2 class="number-title"> Consultas: Criterios</h2>

A continuación se presentan  distintos operadores que podemos utilizar en una condición/criterio dentro de una regla de validación y/o consulta.

<h3>Campos calculados:</h3>


<p>
Al igual que podemos definir en una tabla un campo cuyo tipo de datos sea Calculado también podemos incluir campos
calculados en las consultas.
</p>

<p>
¿Cuándo incluir la expresión en una tabla y cuándo en una consulta? La respuesta dependerá de cada caso concreto. 
Si el resultado de la expresión se va a utilizar frecuentemente en consultas, listados o estadísticas, puede ser más
interesante guardar el dato en la propia tabla. Si en cambio se trata de un cálculo más específico puede ser preferible
no utilizar espacio en el disco para conservar estos valores, definiendo un campo calculado en la consulta.
</p>

<p>
 Para definir un campo como calculado, simplemente deberemos escribir una expresión en el espacio reservado 
 para indicar el campo. La sintaxis será:
</p>

 <center> 
  <b>Nombre del campo: expresión</b>
</center>
 


<h3>Encabezados de columna:</h3>

<p>
 Podemos cambiar el encabezado de las columnas del resultado de la consulta.
</p>
<p>
 Normalmente aparece en el encabezado de la columna el nombre de la columna, si queremos cambiar ese encabezado lo 
 indicamos en la fila Campo: escribiéndolo delante del nombre del campo y seguido de dos puntos ( : ). Se suele 
 utilizar sobre todo para los campos calculados.
</p>


<h3>Consultas con parámetros:</h3>

<p>
 A menudo, en una consulta necesitamos utilizar un valor que no es conocido en ese momento sino que queremos que lo
 introduzca el usuario cuando se ejecute la consulta. 
</p>

<p>
 En este caso necesitamos utilizar en nuestra consulta un parámetro. Un parámetro funciona de forma parecida 
 a un campo de tabla, pero el valor que almacena lo introduce el usuario cuando se ejecuta la consulta.
</p>
<p>
 En una consulta cuando utilizamos un nombre de campo que no está en el origen de datos, Access considera este campo como un parámetro y cuando se ejecuta la consulta nos pide Introducir el valor del parámetro mediante un cuadro de diálogo
</p>


<p>
 <b>Observacion</b> Cuando pongamos el nombre del parámetro es importante escribirlo entre corchetes,
 de lo contrario Access le añadirá comillas y no lo considerará como un nombre de parámetro sino como un valor.
</p>

<p>
 Otra forma de utilizar un parámetro en una consulta es definiéndolo mediante el botón Parámetros de la pestaña Diseño.
 La diferencia entre escribir directamente un nombre de parámetro y definirlo con el botón Parámetros es que, 
 si le hemos asignado un tipo de dato, Access comprueba automáticamente el tipo del valor introducido por el usuario.
</p>


<h3>Los operadores de comparación</h3>

<p>Estos operadores comparan el valor de una expresión con el valor de otra. Independientemente del operador 
   si uno de los valores es nulo, el resultado de la comparación será nulo (ni verdadero ni falso).</p>

<h3>El operador Entre</h3>

<p>Tiene la siguiente sintaxis:</p>

<center><b> Expresión Entre valor1 Y valor2 </b></center>
<p>Examina si el valor de la expresión está comprendido entre los dos valores definidos por valor1 y valor2.
   Normalmente la expresión será un nombre de campo.</p>

<h3>El operador In</h3>

<p>Tiene la siguiente sintaxis:</p>

<center> <b>Expresión In (valor1, valor2, ...)</b></center>

<p>Examina si el valor de la expresión es uno de los valores incluidos en la lista de valores escritos entre paréntesis.</p>



<h3>El operador Es nulo</h3>

<p>
Cuando una columna que interviene en una condición contiene el valor nulo, el resultado de la condición no es verdadero 
ni falso, sino nulo, sea cual sea el test que se haya utilizado. Por eso si queremos listar las filas que no tienen valor
en una determinada columna, no podemos utilizar la condición columna = nulo debemos utilizar un operador especial,
 el operador Es nulo. Tiene la siguiente sintaxis:
</p>
<center><b>Expresión Es nulo, </b> </center>
<p>donde expresión normalmente será un nombre de columna.</p>

<h3>El operador Como    </h3>
<p>Se utiliza cuando queremos utilizar caracteres comodines para formar el valor con el que comparar.</p>

<p>
Por ejemplo queremos visualizar los empleados cuyo nombre acabe en 'o'. Tenemos que utilizar el comodín *
y utilizar el operador <b>Como</b> para que Access reconozca el * como un comodín y no como el carácter asterisco.
La condición sería nombre como '*o'.
</p>

<p>
 El valor que contiene los comodines se conoce como patrón y tiene que ir encerrado entre comillas (simples o dobles). 
 La sintaxis es la siguiente:
</p>
<center> <b>Expresión Como 'patrón'</b></center>

<p>En la siguiente tabla te indicamos los caracteres comodines que se pueden poner en un patrón y su significado.</p>

<table class="info">
    <tr>
      <th>Caracteres en patr&oacute;n</th>
      <th>Significado</th>
    </tr>
    <tr>
      <td>?</td>
      <td>Un car&aacute;cter cualquiera</td>
    </tr>
    <tr>
      <td>*</td>
      <td>Cero o m&aacute;s caracteres</td>
    </tr>
    <tr>
      <td>#</td>
      <td>Un d&iacute;gito cualquiera (0-9)</td>
    </tr>
    <tr>
      <td><strong>[</strong>ListaCaracteres<strong>]</strong></td>
      <td>Un car&aacute;cter cualquiera de listacaracteres</td>
    </tr>
    <tr>
      <td><strong>[!</strong>ListaCaracteres<strong>]</strong></td>
      <td>Un car&aacute;cter cualquiera no incluido en listacaracteres</td>
    </tr>
  </table>


<ul>
  <li>
     <p>
     <b>ListaCaracteres:</b> representa una lista de caracteres y puede incluir casi cualquier carácter, incluyendo dígitos, 
      los caracteres se escriben uno detrás de otro sin espacios en blanco ni comas. Por ejemplo para sacar los nombres
      que empiezan por a,g,r o v el patrón sería: '[agrv]*'
    </p>
  </li>

    <li>
    <p>
    Los caracteres especiales corchete de apertura [, interrogación ?, almohadilla # y asterisco * dejan de ser 
    considerados comodines cuando van entre corchetes. Por ejemplo para buscar los nombres que contienen un asterisco,
    el patrón sería: '*[*]*' en este caso el segundo * dentro del patrón no actúa como comodín sino como un carácter 
    cualquiera porque va dentro de los corchetes.
    </p>
    </li>
  
    <li>
     <p>Si no se encierra entre corchetes, la exclamación ! representa el carácter exclamación.</p>
    </li>
    
    <li>
    <p>
    El corchete de cierre ] se puede utilizar fuera de una listacaracteres como carácter independiente pero no se puede
    utilizar en una listacaracteres. Por ejemplo, el patrón 'a]*' permite encontrar nombres que empiecen por una a seguida de un corchete de cierre.
    </p>
    </li>

    <li>
    <p>La secuencia de caracteres [] se considera una cadena de caracteres de longitud cero ("").</p>
    </li>

    <li>
    <p>
    Se puede especificar un intervalo de caracteres en ListaCaracteres colocando un guión - para separar los límites inferior y superior del intervalo.
    Por ejemplo, la secuencia [A-Z ] en patrón representa cualquier carácter comprendido en el intervalo de la A a la Z. 
    Cuando se especifica un intervalo de caracteres, éstos deben aparecer en orden ascendente (de menor a mayor).[A-Z] es un intervalo válido,
    pero [Z-A] no lo es. Se pueden incluir múltiples intervalos entre corchetes, sin necesidad de delimitadores. 
    El guión - define un intervalo únicamente cuando aparece dentro de los corchetes entre dos caracteres, en cualquier otro caso representa el carácter guión.
    </p>
    </li>
  
    <p><b>Ejemplo</b></p>
     Por ejemplo queremos saber los alumnos de determinada provincia (son los que tienen un código postal
     que empieza por 46 seguido de tres dígitos cualesquiera, la condición podría ser [código postal] como '46###'
    </ul>




</div>


</body>
